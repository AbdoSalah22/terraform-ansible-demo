---
- name: Configure Web Server
  hosts: webservers
  become: yes
  gather_facts: no

  tasks:
    - name: Update and install Docker
      raw: |
        apt-get update
        apt-get install -y docker.io
        systemctl start docker
        systemctl enable docker
        usermod -aG docker ubuntu
      args:
        executable: /bin/bash

    - name: Run Nginx container
      raw: |
        docker rm -f my-web-app 2>/dev/null || true
        docker run -d --name my-web-app --restart always -p 80:80 nginx
      args:
        executable: /bin/bash